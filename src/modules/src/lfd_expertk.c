
#include "FreeRTOS.h"
#include "queue.h"
//#include "task.h"
#include "semphr.h"
#include "debug.h"

#include "stabilizer.h"


// Declare functions to use:

void expert_K(int K_column,float *Kldf);


// ====================================
//

static float K1[567] = {0.41123179,0.39261296,0.37693357,0.37720108,0.36200997,0.36178190,0.33424369,0.32535329,0.31524825,0.27160105,0.27315003,0.23896964,0.25613135,0.23520282,0.21904261,0.22305386,0.19423662,0.21410519,0.18388557,0.16906378,0.16153988,0.10217534,0.11795156,0.083772063,0.12940384,0.12317943,0.10032547,0.12810493,0.093156226,0.11462618,0.056471627,0.054511540,0.059549626,0.036947548,0.028070055,-0.065209672,-0.034405325,-0.048012633,-0.075438038,-0.010549661,-0.045050208,-0.0094231619,-0.073477261,-0.043717824,-0.018459927,-0.037665043,-0.030786525,-0.14235018,-0.13422446,-0.24739307,-0.24981184,-0.27885151,-0.33781883,-0.30716130,-0.40708736,-0.38386148,-0.37749061,-0.40113801,-0.49139789,-0.68362564,-0.59766144,-0.67298794,-0.65149987,-0.72805190,-0.87101275,-0.77366704,-0.86913246,-0.78481221,-0.90674728,-0.91267323,-0.89110982,-0.98216933,-0.94856131,-1.1467781,-1.0613983,-1.1076940,-1.2373662,-1.2511964,-1.4382664,-1.3310168,-1.5636367,-1.4893395,-1.5983285,-1.6406957,-1.4755509,-1.6928185,-1.6013814,-1.6672062,-1.8374882,-1.8156651,-2.0752592,-1.8632245,-2.1573839,-2.1245332,-2.2611883,-2.1761105,-2.0168979,-2.3306320,-2.2774992,-2.3873625,-2.2251711,-2.2711082,-2.6050603,-2.4204950,-2.5403838,-2.2556386,-2.1628919,-2.3391898,-2.3449216,-2.5923674,-2.3530157,-2.5899651,-2.5919359,-2.9259984,-3.3893352,-3.1855438,-3.6764278,-3.5531538,-4.3437552,-4.5176868,-4.6307445,-5.0687504,-5.0378761,-5.8151560,-5.5847063,-6.0409946,-6.1053705,-6.1555395,-6.9096174,-6.4943070,-7.3620615,-7.1909389,-7.1805749,-7.7543626,-7.4586744,-8.5746441,-7.9543104,-8.6586485,-8.5633059,-8.3417101,-8.9539709,-8.0801859,-8.9146910,-8.3197823,-8.5998878,-9.3810301,-9.0272102,-10.371949,-9.1936836,-9.5493860,-9.0552082,-9.3100996,-10.479566,-9.6736231,-10.498116,-9.4667654,-10.784390,-11.809652,-11.446748,-13.233186,-12.238822,-13.340964,-13.380194,-13.820518,-14.326038,-13.752958,-14.907522,-13.350028,-14.785335,-13.662337,-12.406315,-14.140597,-14.070716,-15.621557,-12.784513,-12.450933,-12.841695,-12.961820,-14.005299,-12.480769,-14.201339,-12.831972,-11.497449,-11.653190,-10.800713,-12.753286,-10.288610,-10.557684,-9.3474874,-9.9495068,-10.702207,-8.9734926,-11.393139,-10.387977,-11.245337,-12.648595,-11.948704,-14.570831,-12.746844,-14.857908,-14.846007,-16.256739,-16.925171,-16.336191,-18.849058,-16.813557,-13.947796,-11.989682,-10.929066,-11.881078,-9.5373363,-10.955455,-8.3519001,-9.7294035,-10.919113,-9.9694118,-12.618613,-11.196409,-10.777658,-9.4416389,-8.1798134,-9.2878952,-6.5466986,-7.6485081,-4.4350743,-5.0129304,-5.5014868,-4.2253346,-6.1363058,-4.2073421,-6.6744461,-5.1712179,-4.1988220,-6.9027705,-7.6353674,-10.484149,-7.3121796,-7.8297653,-8.4414463,-7.2103500,-7.2882113,-4.0210366,-5.4296632,-3.3078895,-2.3960531,-0.73949867,0.41636786,-1.1297374,1.1661407,0.79075223,3.8378515,3.6576662,2.7780542,3.8160155,1.9685594,1.7602365,0.15238376,1.2746512,2.0924866,0.39768684,2.3958721,1.5750313,4.1412044,3.5164905,3.3775554,4.6568966,3.4003379,4.8539124,2.7570837,3.7791791,4.4189777,3.4796996,4.8667746,3.7355938,5.7935810,4.9239988,4.4610000,6.2636018,4.8653865,5.9054031,5.7670064,6.5403528,6.8964758,6.1238070,7.1840940,6.4333572,8.2292290,7.3188367,7.5259757,6.4809175,5.5397315,5.9882340,4.3256040,5.1144128,4.5073357,4.8373084,4.9985843,3.1226974,4.2149301,2.8607557,3.0588539,3.5385625,2.8539586,4.3867879,2.3968949,3.0795996,2.4093347,2.9807966,3.3789716,1.8222812,3.2854016,3.3586838,4.5869246,4.0151482,3.5251145,3.9645863,2.8904696,3.7566199,2.3950453,3.0610821,2.5896478,2.1639700,3.1536496,2.3547006,2.4255192,1.8907601,2.3053088,2.8839335,1.9778289,2.5310960,0.99423975,1.4862041,1.4785345,0.22539669,0.12146422,-1.1868383,0.021035289,-0.066074371,-0.062502444,-0.50094759,-0.81280529,0.44156563,-0.77358711,-0.15356709,0.20273562,0.44012836,0.53131080,-0.60861462,0.23662376,-0.39566961,-0.39757243,-0.038824443,-0.47421256,0.44394881,-0.62273157,-0.17897938,-0.31364673,-0.70911819,-0.72621578,-1.3442494,-0.84237134,-1.3746682,-0.31958687,-0.80956054,-1.3036704,-0.45391780,-0.48205057,0.14411904,-0.98823696,-0.73136801,-0.48881185,-0.71064395,-0.60666412,-1.6312830,-0.95926797,-1.4251674,-1.1884792,-0.99735337,-1.9001372,-1.5940669,-1.9328257,-1.5306253,-1.3847388,-2.1858511,-1.7664634,-2.2987254,-1.4326906,-1.7308098,-1.5325036,-1.2060418,-1.7935325,-1.5180792,-2.3117845,-2.1287353,-2.4530377,-2.2269461,-1.9762539,-2.5195310,-1.6374393,-1.7701643,-1.5764866,-1.2687384,-1.4007900,-0.73366195,-1.0194343,-0.57460707,-1.2215568,-0.96032917,-0.85087240,-1.1731617,-0.70922595,-0.97574961,-0.97236180,-1.2083610,-1.3869474,-1.1440117,-1.5273303,-1.1873492,-1.4930412,-1.3211397,-1.2359556,-1.5021496,-1.4746510,-2.1885300,-1.5821341,-1.8139265,-1.7083198,-1.4359289,-1.9822212,-1.7557583,-1.9015040,-1.6979610,-1.6312964,-1.9177427,-1.9294043,-2.5530713,-2.1673145,-2.3860254,-2.1972313,-1.8316057,-2.0000820,-1.6097431,-1.9864423,-1.7136754,-1.7969964,-2.0828271,-1.9893860,-2.4682970,-2.1750662,-2.4500105,-2.4836898,-2.6400118,-2.6444826,-2.4259913,-2.6618292,-2.3354356,-2.6669838,-2.4276588,-2.2270291,-2.3669150,-1.9626750,-2.0723751,-1.4549702,-1.4403526,-1.5899798,-1.3014084,-1.4571511,-1.1376102,-1.4100425,-1.0524206,-0.84236765,-1.1091105,-1.1211761,-1.5013595,-1.1991760,-1.2900940,-1.1820240,-0.85593754,-0.95678341,-0.65159106,-0.87203014,-0.65675223,-0.65998554,-0.85975468,-0.87852550,-1.2993689,-0.85344970,-0.85836661,-0.93327284,-1.0166440,-1.0292550,-0.75777709,-0.91313469,-0.70316696,-0.59854531,-0.36438265,-0.24862999,-0.58115816,-0.39117986,-0.45556456,-0.25823405,-0.46118373,-0.55474323,-0.21640019,-0.41479966,-0.38446400,-0.57311320,-0.46053454,-0.34056318,-0.42982894,-0.21594280,-0.42098781,-0.41494700,-0.51978958,-0.61268222,-0.40543899,-0.63751447,-0.62765789,-0.64489239,-0.49844277,-0.25699073,-0.45158449,-0.49358287,-0.78577614,-0.55836761,-0.75860399,-0.76275957,-0.70366657,-0.74446207,-0.37541020,-0.38289845,-0.094372220,-0.035409190,-0.37892926,-0.23224181,-0.42693049,-0.21868700,-0.38345203,-0.53890055,-0.54459232,-0.63877183,-0.48344293,-0.70193440,-0.63207805,-0.58024043,-0.58092797,-0.46417847,-0.55233204,-0.24898146,-0.34689441,-0.44257924,-0.44494331,-0.55869293,-0.45382109,-0.48991075,-0.31981426,-0.41464168,-0.19198333,0.0071558901,-0.0058610565,0.14413102,0.016554618,0.036932275,-0.012639719,0.038840078,0.42475924,0.42360225};
static float K2[567] = {11.135068,10.780944,10.472123,10.324153,10.035252,9.8847914,9.5407324,9.3623743,9.1916809,8.8038530,8.7188148,8.4129190,8.4434605,8.2511501,8.0880270,8.0166693,7.8154712,7.8805957,7.6483703,7.5256763,7.4455581,7.1377053,7.1364741,6.9233432,7.0656586,6.9892392,6.8574247,6.9190760,6.7303829,6.7361403,6.4834571,6.4264975,6.4003234,6.2588887,6.1909308,5.8755326,5.9139042,5.8253055,5.7085032,5.8520699,5.7120156,5.7572184,5.5515299,5.5884423,5.6059370,5.4975200,5.4664192,5.1888747,5.1674218,4.8959031,4.8490124,4.8126826,4.6754756,4.7066150,4.4803662,4.4886804,4.5000486,4.4196415,4.2128968,3.8863006,4.0322747,3.9271939,3.9384274,3.8088171,3.5929506,3.7325385,3.5705180,3.6674201,3.4705553,3.4612432,3.4986227,3.3403513,3.3684714,3.1084926,3.1805141,3.1191854,2.9746752,2.9324596,2.7081039,2.8218007,2.5690515,2.6580219,2.5127070,2.4460607,2.6109130,2.3806024,2.4561765,2.4001739,2.2526007,2.2446494,1.9870336,2.1750274,1.9145410,1.9493998,1.7967175,1.8670638,2.0101848,1.7562981,1.7801899,1.7024956,1.8011712,1.7567341,1.4822377,1.6173885,1.5338755,1.7381471,1.8103223,1.6487383,1.6440192,1.4302067,1.5879374,1.4247576,1.3818828,1.1488196,0.84639835,0.97425014,0.63414139,0.69147277,0.19325906,0.078041337,0.014532207,-0.27915549,-0.28887656,-0.75233680,-0.61727786,-0.86641854,-0.92357296,-0.98057675,-1.3773931,-1.1269577,-1.5877140,-1.4876260,-1.4353725,-1.7406121,-1.5842925,-2.1398354,-1.7933270,-2.1071632,-2.0710111,-1.9798062,-2.2495694,-1.7955512,-2.1835990,-1.8943602,-2.0494370,-2.4368331,-2.2376697,-2.8050070,-2.2455497,-2.3690624,-2.1718585,-2.2636886,-2.7717319,-2.4267066,-2.7849467,-2.3600793,-2.8959930,-3.3525677,-3.1784532,-3.8758678,-3.4844291,-3.9360721,-4.0065546,-4.1645570,-4.3471136,-4.1487718,-4.6216083,-4.0491066,-4.5818443,-4.1523533,-3.6675289,-4.2906895,-4.2337890,-4.7947330,-3.7812867,-3.6702962,-3.7922049,-3.8211319,-4.2247219,-3.7349000,-4.3224082,-3.8610935,-3.4205463,-3.5320566,-3.2652698,-3.9274161,-3.1255307,-3.2220600,-2.8809571,-3.0815482,-3.3075016,-2.7442193,-3.4882433,-3.1798861,-3.4770055,-3.9867997,-3.7701461,-4.5727177,-4.0528359,-4.7178674,-4.7882223,-5.2009444,-5.3972816,-5.2689171,-6.0548778,-5.5038958,-4.6984148,-4.1327991,-3.8580852,-4.1975751,-3.5938828,-4.0541134,-3.3270667,-3.7183959,-4.0563207,-3.8478785,-4.6223598,-4.2822671,-4.2555852,-3.8965218,-3.5626771,-3.9259741,-3.2371275,-3.5829906,-2.7291806,-2.8907869,-3.0280476,-2.7495780,-3.2921147,-2.8363502,-3.4739859,-3.0904100,-2.8485503,-3.5563996,-3.7215424,-4.4601483,-3.6900797,-3.8555753,-4.0530329,-3.8501318,-3.9205515,-3.1547549,-3.5801899,-3.1246052,-3.0448692,-2.6810186,-2.4507108,-2.8943594,-2.4075704,-2.5802507,-1.8685670,-1.9429486,-2.2451038,-2.0871048,-2.5692167,-2.6187012,-3.0524011,-2.8240540,-2.6674480,-3.1142998,-2.7049165,-2.9515958,-2.3694131,-2.5327981,-2.5954998,-2.3836901,-2.7293398,-2.4266467,-2.9147310,-2.6870799,-2.5462193,-2.8372920,-2.5754046,-2.8898988,-2.4175770,-2.6067410,-2.7143886,-2.3234816,-2.6795163,-2.4758828,-2.6152439,-2.4611697,-2.4131978,-2.6734309,-2.5184510,-2.7637608,-2.3773530,-2.6099417,-2.6661222,-2.9047904,-3.1155891,-3.0768869,-3.4580398,-3.2970669,-3.4948742,-3.3951621,-3.3221765,-3.6902349,-3.4485097,-3.7190652,-3.7246027,-3.6764677,-3.8016207,-3.4304926,-3.7882559,-3.6198647,-3.8158991,-3.6709847,-3.5526502,-3.8434820,-3.5508587,-3.4589233,-3.2152917,-3.2997968,-3.3878102,-3.3635581,-3.5932794,-3.4293199,-3.6235538,-3.4422681,-3.5550854,-3.6590965,-3.4711237,-3.6131692,-3.6575782,-3.7162817,-3.6744485,-3.5962660,-3.7639997,-3.6969333,-3.9033475,-3.7639081,-3.7466083,-3.9393110,-3.8901703,-4.0800824,-3.8474617,-3.7513366,-3.6479018,-3.6745462,-3.6762867,-3.3897789,-3.5105102,-3.3524168,-3.2501371,-3.1776936,-3.1094992,-3.2139831,-3.0470042,-3.0903747,-3.1486032,-3.1641183,-3.1761019,-3.0193715,-3.1158352,-3.0354159,-3.0756328,-3.1801684,-3.1836660,-3.3159482,-3.2858038,-3.3495848,-3.1696336,-3.1887329,-3.1905875,-3.0712035,-3.0033541,-2.9275360,-2.9807532,-2.9081192,-2.8199325,-2.8666825,-2.8068433,-2.8326635,-2.7250831,-2.6698179,-2.6473804,-2.6459494,-2.6776142,-2.6381760,-2.6568682,-2.5505536,-2.4724720,-2.4806905,-2.4634435,-2.4841149,-2.3822124,-2.3566270,-2.3882120,-2.4191515,-2.4468262,-2.4508538,-2.4486957,-2.4296274,-2.4825385,-2.4572036,-2.4162273,-2.4011674,-2.3611507,-2.3516245,-2.3972070,-2.4594426,-2.4552679,-2.4526196,-2.4693611,-2.4827662,-2.4280136,-2.3994772,-2.3825066,-2.4201803,-2.4556141,-2.4738703,-2.5438557,-2.5052936,-2.4772613,-2.5289257,-2.5317862,-2.5666268,-2.4361336,-2.4208000,-2.4158907,-2.4457221,-2.4219463,-2.3337853,-2.3250053,-2.2613471,-2.3042386,-2.3808341,-2.3470466,-2.3831151,-2.4109900,-2.3965938,-2.3909965,-2.4236307,-2.4118547,-2.3157301,-2.3404436,-2.2880256,-2.3543260,-2.4788442,-2.4346189,-2.4856529,-2.4596336,-2.5233264,-2.5698953,-2.5798929,-2.5648746,-2.4833541,-2.5630674,-2.5376217,-2.6162605,-2.5700960,-2.5696042,-2.6637216,-2.6565659,-2.7587681,-2.6427176,-2.6544044,-2.6636944,-2.6586149,-2.7544446,-2.7365804,-2.8585639,-2.8433781,-2.8421698,-2.9738111,-2.9726586,-3.0846531,-3.0091913,-3.0688841,-3.0942650,-3.0073476,-2.9595494,-2.8632851,-3.0089552,-2.9976645,-3.1210358,-3.3462358,-3.3897693,-3.5603817,-3.4861023,-3.5795083,-3.6339974,-3.6534324,-3.6689045,-3.4961641,-3.6926661,-3.7328658,-3.7188749,-3.7043350,-3.7526300,-3.9649303,-4.0418525,-4.2417498,-4.4631701,-4.5896816,-4.6642947,-4.5098448,-4.6646538,-4.6024508,-4.7541170,-4.6601729,-4.6560965,-4.8958583,-4.8691549,-4.9061098,-4.8805246,-5.0133810,-5.1093855,-5.1363859,-5.3341246,-5.2352853,-5.3363910,-5.2239823,-5.1291623,-5.3341289,-5.3012609,-5.5022159,-5.7432857,-5.9339304,-6.1659427,-6.0230346,-5.8988447,-5.5879107,-5.7297878,-5.4927592,-5.5653234,-5.6973243,-5.7068224,-6.0297465,-6.0111136,-6.2699394,-6.3664231,-6.0540376,-6.2967019,-6.1345673,-6.3515577,-6.1028357,-5.7898359,-5.6808219,-5.4715776,-5.6587720,-5.4864311,-5.6808338,-5.9181395,-6.0892963,-6.2763624,-6.1791472,-6.5482407,-6.3714418,-6.2163186,-6.3255110,-6.1494856,-6.3472075,-6.3383360,-6.6058002,-6.5008650,-6.8029261,-7.0926404,-7.1783304,-7.5053234,-7.3418765,-7.4814410,-7.2765260,-7.2503772,-7.6831770,-7.5515227};

// =============================================
// Getters and Setters

void expert_K(int K_column,float *Klfd)
{
    if (K_column<0 || K_column>566){
        DEBUG_PRINT("FUCK");
    }
    Klfd[0] = K1[K_column];
    Klfd[1] = K2[K_column];

}


